import javax.swing.JFrame;
import javax.swing.JPanel;

import org.jfree.chart.ChartFactory;
import org.jfree.chart.ChartPanel;
import org.jfree.chart.JFreeChart;
import org.jfree.chart.plot.PlotOrientation;
import org.jfree.data.xy.XYSeries;
import org.jfree.data.xy.XYSeriesCollection;


public class GraphBuilder {
	private Sampling s;
	
	public GraphBuilder(Sampling s){
		this.s = s;
	}
	
	private XYSeries buildSeriesAgainstTime(String name, Sampling s, double values[],double stepSize){
		XYSeries plot = new XYSeries(name);
		for(double i = 0; i < values.length; i += stepSize){
			plot.add((i / (s.getSamplingRate() / 1000)) * stepSize, values[(int) i]);
		}
		return plot;
	}
	
	public JPanel buildGraph(String name, String axisLabel , double[] values, double stepSize){
		XYSeries original = buildSeriesAgainstTime(name,s,values,1);
        XYSeriesCollection dataset = new XYSeriesCollection();
        dataset.addSeries(original);
  
        JFreeChart chart = ChartFactory.createXYLineChart(
                name + " vs. Time",
                "Time (ms)",
                axisLabel,
                dataset, 
                PlotOrientation.VERTICAL,
                true,
                true,
                false
                );

        JPanel panel = new JPanel();
        ChartPanel chartPanel = new ChartPanel(chart);
        panel.add(chartPanel);
        return panel;
	}
	
	public JPanel buildGraphAllMetrics(double scalingFactor){
		
		XYSeries original = buildSeriesAgainstTime("Signal",s,s.getSampling(),1);
		XYSeries energy = buildSeriesAgainstTime("Energy",s,s.shortTermAverageEnergy(1,0.03),1);
		XYSeries magnitude = buildSeriesAgainstTime("Magnitude",s,s.shortTermAverageMagnitude(1, 0.03),1);
		XYSeries zeroCrossing =  buildSeriesAgainstTime("Average Zero Crossing Rate",s,s.shortTermAverageZeroCrossingRate(1,0.03),1);
		

        XYSeriesCollection dataset = new XYSeriesCollection();
        dataset.addSeries(original);
        dataset.addSeries(energy);
        dataset.addSeries(magnitude);
        dataset.addSeries(zeroCrossing);
        

        JFreeChart chart = ChartFactory.createXYLineChart(
                "All Metrics vs. Time",
                "Time (ms)",
                "s[t],E[t],M[t],Z[t]",
                dataset, 
                PlotOrientation.VERTICAL,
                true,
                true,
                false
                );

        JPanel panel = new JPanel();
        ChartPanel chartPanel = new ChartPanel(chart);
        panel.add(chartPanel);
        return panel;
	}
	
}
